https://claude.ai/chat/83a63aa7-68f7-4b5c-be9b-82b72310fac1

In the current setup there is a misunderstanding:

## Clarification: Signal Head, Signal group, Signalgeber, Signalgruppe

Here’s a concise summary regarding the TrafficStreamConfigData and the <vt> elements compared to DSRC:signalGroup from the provided MAPEM message:

---

## Clarification of <vt> vs. signalGroup

### 1. Semantics according to the Specification:

DSRC:signalGroup:
Represents a logical identifier used in MAPEM/SPATEM messages to indicate a set of lanes or traffic movements (connections) at intersections. It is used at a logical level, reflecting combined signals applicable to particular connections or traffic movements.

<vt> (MapExtension:signalGroups primary/secondary):
The <vt> id is linked to physical or infrastructural signal group IDs, as known in local German traffic engineering systems.
The primary/secondary distinction indicates prioritization or an alternate grouping logic (e.g., supplementary signaling or pedestrian signaling attached to a vehicle movement).

In short:
- signalGroup in DSRC/MAPEM/SPATEM is logical and connection-focused (movement-centric).
- <vt> id in TrafficStreamConfigData explicitly relates to a German local physical/infrastructure signal group and can map to one or multiple DSRC:signalGroups.

---

### 2. Analysis of the Provided Example:

The DSRC signalGroup ids range higher (up to 22 in the provided XML), and the <vt> ids range up to 10 only.
This discrepancy arises naturally because multiple logical signal groups (C-ITS standard) can map to a single German physical signal group (as represented by <vt>).
The TrafficStreams <vt> defines a stable identifier for physically installed traffic-light groups at intersections (Signalgruppe in German traffic engineering). In contrast, the DSRC-defined signalGroup identifiers express each separate logical connection from a specific lane to another lane or road segment.
Thus, one physical <vt> (German signal group) can correlate with multiple logical DSRC signalGroups, which handle different connections controlled by the same physical signals.

Example from your XML:
- Physical Signal Group (German terminology): <vt>1 can logically control multiple different connections (DSRC:signalGroup 1, 3, etc.).

---

### 3. Legal and Practical Background in Germany:

In Germany, legal implications of traffic signaling require clarity regarding permitted movements. The SPATEM/MAPEM framework transmits:
- A logical signaling (signalGroup) describing permitted movements (left, right, straight, pedestrian) clearly defined in MAPEM.
- Legal relevance: vehicles must obey signals according to StVO (Straßenverkehrsordnung). The transmitted signalGroup states (event states such as "stop-And-Remain", "protected-Movement-Allowed") convey the current legal obligations applicable to vehicles for the defined connection.
- The physical grouping <vt> (German signal group) represents how the roadside signals are controlled physically at the intersection controller. Each signalGroup in the SPATEM is tied clearly back to MAPEM-defined connections, which link it to the correct physical German signal group (<vt>).

For instance, at an intersection:
- Physical German signal group (vt=1) = Left-turn signals on ingress lane 1.
- C-ITS may define multiple logical signalGroups for different movements (e.g., left-turn into lane A or left-turn into lane B), each receiving a separate DSRC signalGroup ID in SPATEM.
- The logical DSRC signalGroup would be responsible for conveying the current state (e.g., permissive, protected, or stop) of these specific movements, thus linking them back to the single German physical group id (vt=1).

---

### 4. Practical Recommendation (to Avoid Confusion):

When documenting and mapping intersections:
Clearly distinguish between physical German IDs (<vt>) and logical DSRC signalGroups.
Document clearly which DSRC signal groups (logical) map onto each German physical signal group (vt).
Note explicitly that one German physical signal group can control multiple logical DSRC signalGroups (connections).
---

## Summary (Brief):
- <vt>: corresponds to the physical German signal groups (infrastructure-side).
- DSRC:signalGroup: a logical grouping per defined traffic movements, controlled by one or more physical <vt> signal groups.

This distinction is key for a proper understanding of MAPEM/SPATEM messages, the precise mapping to real-world signal heads (Signalgeber), and ultimately, compliance with traffic rules according to German law (StVO).

To write clear, unambiguous, and easily maintainable code, especially when parsing XML messages in a mixed terminology context (C-ITS vs. German traffic engineering), I recommend the following consistent naming convention:

### Recommended Naming Convention:

Physical Signal Group (German "Signalgruppe"):
Use the term: physicalSignalGroupId
Source element: <MapExtension:vt>
Meaning: Refers explicitly to the physical traffic signal group id as defined by German infrastructure control.

Logical Signal Group (C-ITS/SPATEM/MAPEM):
Use the term: logicalSignalGroupId
Source element: <DSRC:signalGroup>
Meaning: Refers to logical identifiers for movements (lane-to-lane connections), typically described in MAPEM and SPATEM messages.

Physical Signal Head (German "Signalgeber"):
Use the term: signalHeadId
Source: usually not directly in MAPEM/SPATEM but relevant when referring explicitly to physical hardware.
Meaning: individual physical traffic signal (e.g. Red/Amber/Green lights).

---

## Example (Recommended Documentation Style):

| physicalSignalGroupId (vt) | DSRC signalGroup IDs | Explanation |
|-----------------------------|------------------------------------|------------------|
| 1 | [1, 3, 7] | Controls multiple movements (e.g., straight, left-turn) |
| 2 | 8, 12 | Controls different connections at intersection |
| 3 | 5, 9 | Another physical group controlling logically distinct movements |

---

### Legal and Practical Background (Germany, StVO context):

physicalSignalGroupId corresponds directly to the legally relevant traffic control group ("verkehrsrechtliche Signalgruppe").
signalGroup (logical) in SPATEM indicates permitted or prohibited movements in accordance with StVO. For instance, stop-And-Remain means mandatory stop at stop line; protected-Movement-Allowed is analogous to a green light.
Software processing SPATEM messages must map logical signalGroup ids to physical signal groups (physicalSignalGroupId) to accurately reflect traffic laws for driver-assistance systems or automated vehicles.
---

### Recommended Best Practice to Prevent Future Misunderstandings:

Always use explicit terms (physicalSignalGroupId, logicalSignalGroupId, and signalHeadId) to avoid ambiguity.
Clearly document the mapping between logical and physical groups in a separate metadata or intersection mapping configuration file.
This ensures clarity for developers, integrators, and engineers, and promotes alignment with existing German traffic control and legal definitions.

Meaning in your code the Intersection, MapemParse StgParser classes (and maybe others) need to be updated as described above to prevent ambiguity. Write out all class names that need to be changed or added first.